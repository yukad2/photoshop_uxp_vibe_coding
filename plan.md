# テクスチャパッキングツール実装計画

## 概要
Photoshop UXPプラグインとして、テクスチャマップ（AO, Roughness, Metalness）を効率的にパッキングするツールを開発する。

## 機能要件

### UIコンポーネント
- **R:AO Create** ボタン - Ambient Occlusionマップ用レイヤーグループ作成
- **G:Rough Create** ボタン - Roughnessマップ用レイヤーグループ作成  
- **B:Metal Create** ボタン - Metalnessマップ用レイヤーグループ作成
- **Export** ボタン - RGBチャンネル合成エクスポート

### 機能詳細

#### Create系ボタン動作
各ボタン押下時の処理：
1. 対応するレイヤーグループを作成
   - `R_AO` (Ambient Occlusion)
   - `G_Roughness` (Roughness)
   - `B_Metalness` (Metalness)
2. グループ内にベース白レイヤーを自動作成
3. モノクロ作業用の表示設定を適用
4. 既存グループの重複チェックと警告表示

#### Export機能
1. 各チャンネル用レイヤーグループの存在確認
2. チャンネル別合成処理
   - Rチャンネル: R_AOグループの内容
   - Gチャンネル: G_Roughnessグループの内容
   - Bチャンネル: B_Metalnessグループの内容
3. 最終テクスチャマップの生成
4. エクスポートオプション
   - 新規ドキュメント作成
   - 現在ドキュメントに新規レイヤー追加
   - ファイル保存ダイアログ表示

## 技術実装

### 使用API
- **Photoshop DOM API**: 基本レイヤー操作
- **batchPlay API**: 高度な合成・エクスポート処理
- **UXP File System**: エクスポートファイル管理

### ファイル構成と変更点

#### index.html
- 既存のボタンを削除
- 新しい4つのボタンUIを実装
- レスポンシブレイアウト対応

#### script.js
- 既存のサンプル関数を削除
- レイヤーグループ作成関数群
- チャンネル合成ロジック
- エクスポート処理関数
- エラーハンドリング強化

#### styles.css
- ボタングリッドレイアウト
- テクスチャタイプ別の色分け
- 状態表示UI（成功/エラー/警告）

#### manifest.json
- 必要に応じてファイルシステム権限追加
- プラグイン名とラベルの更新

### エラーハンドリング
- アクティブドキュメント存在確認
- レイヤーグループ重複検出
- エクスポート時の必須グループ存在確認
- ファイル保存権限エラー対応

### ユーザビリティ考慮事項
- 処理進行状況の表示
- 操作結果のフィードバック
- 直感的なボタン配置とアイコン
- ツールチップによる説明

## 実装フェーズ

### Phase 1: UI基盤
1. HTMLレイアウト更新
2. CSSスタイリング
3. 基本イベントハンドラー設定

### Phase 2: Create機能
1. レイヤーグループ作成ロジック
2. ベースレイヤー自動生成
3. 重複チェック機能

### Phase 3: Export機能
1. チャンネル合成アルゴリズム
2. エクスポート処理
3. ファイル保存機能

### Phase 4: 最適化・テスト
1. エラーハンドリング強化
2. パフォーマンス最適化
3. ユーザビリティ改善

## 想定される技術課題
- batchPlayによる複雑な合成処理
- レイヤーブレンドモードの適切な設定
- 大容量テクスチャでのメモリ管理
- クロスプラットフォーム互換性

## 成功指標
- 各Create機能の正常動作
- エクスポート機能の品質確保
- エラー処理の適切な実装
- ユーザーフレンドリーなUI
